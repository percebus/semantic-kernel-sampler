# SEE: https://pypyr.io/docs/getting-started/conditional-logic/#multiple-steps-with-the-same-condition
context_parser: pypyr.parser.keyvaluepairs
steps:
  - name: pypyr.steps.echo
    in:
      echoMe: "= pypyr qa ==================================================="
  - name: pypyr.steps.default
    comment: set default values for optional cli inputs
    in:
      defaults:
        path: .
        clean: True
        sync: True
        build: True
        style: True
        lint: True
        test: True
        integration: False
        stats: True

  - name: pypyr.steps.shell
    run: "{clean}"
    in:
      cmd: "uvx -- pypyr clean path={path}"

  - name: pypyr.steps.shell
    run: "{sync}"
    in:
      cmd: "uvx -- pypyr sync path={path} release=False"

  - name: pypyr.steps.shell
    run: "{build}"
    in:
      cmd: "uvx -- pypyr build path={path} sync=False"

  - name: pypyr.steps.shell
    run: "{style}"
    in:
      cmd: "uvx -- pypyr style path={path} lint=False"

  - name: pypyr.steps.shell
    run: "{lint}"
    in:
      cmd: "uvx -- pypyr lint path={path} stats={stats}"

  - name: pypyr.steps.shell
    run: "{test}"
    in:
      cmd: "uvx -- pypyr test path={path} lint=False stats={stats}"

  - name: pypyr.steps.shell
    run: "{integration}"
    in:
      cmd: "uvx -- pypyr test path={path} integration=True stats=False lint=False"
